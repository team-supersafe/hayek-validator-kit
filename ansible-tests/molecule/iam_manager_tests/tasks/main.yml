---

- name: Initialize RBAC Configuration and Variables
  include_tasks: setup_config.yml

- name: Perform Basic System Validation
  include_tasks: basic_system_checks.yml

- name: Classify and Group Users by Roles
  include_tasks: user_classification.yml

- name: Verify User Creation and Configuration
  include_tasks: create_users_tests.yml

- name: Verify Password Hardening Configuration
  include_tasks: password_hardening_tests.yml

- name: Verify Sudoers Configuration and RBAC
  include_tasks: configure_sudoers_tests.yml

- name: Verify Password Self-Service Setup
  include_tasks: setup_pss_tests.yml

- name: Verify User Permission Files Creation
  include_tasks: create_user_permissions_files_tests.yml

- name: Verify Audit Logs Setup
  include_tasks: setup_audit_logs_tests.yml

- name: Verify Ubuntu User Disablement
  include_tasks: disable_ubuntu_tests.yml

# ========================================
# RBAC VERIFICATION TESTS
# ========================================

- name: Execute Positive Permission Tests
  include_tasks: rbac_tests/positive_tests.yml

- name: Execute Negative Permission Tests
  include_tasks: rbac_tests/negative_tests.yml

- name: Execute Real Command Execution Tests
  include_tasks: rbac_tests/execution_tests.yml

- name: Validate Against Role Templates
  include_tasks: rbac_tests/template_validation.yml

- name: Generate Detailed Command Execution Logging
  include_tasks: logging.yml

- name: Generate Final Security Report and Decision
  include_tasks: final_report.yml
