---
- name: Convert size string to bytes
  ansible.builtin.set_fact:
    "{{ output_var }}": >-
      {% set size = input_value | regex_replace('^([0-9.]+)\\s*([KMGT])?$', '\\1') | float %}
      {% set unit = input_value | regex_search('[KMGT]$') %}
      {% if unit == 'K' %}
        {{ (size * 1024) | int }}
      {% elif unit == 'M' %}
        {{ (size * 1024 * 1024) | int }}
      {% elif unit == 'G' %}
        {{ (size * 1024 * 1024 * 1024) | int }}
      {% elif unit == 'T' %}
        {{ (size * 1024 * 1024 * 1024 * 1024) | int }}
      {% else %}
        {{ size | int }}
      {% endif %}
