# Validator Viewers - Read-only access for monitoring and reporting
# This file is managed by Ansible - DO NOT EDIT MANUALLY

# Service status viewing
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/systemctl status {{ validator_service }}

# Log viewing commands (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/journalctl -u {{ validator_service }} --no-pager
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/tail -f {{ validator_log_file }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/tail -n 50 {{ validator_log_file }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/less {{ validator_log_file }}

# Configuration viewing (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -la {{ system_solana_install_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -la {{ system_shared_build_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -la {{ validator_root_dir }}

# Process monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/pgrep -f {{ validator_service }}

# Directory space monitoring
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/du -sh {{ validator_ledger_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/du -sh {{ validator_accounts_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -lah {{ validator_ledger_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -lah {{ validator_accounts_dir }}

# Network monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/netstat -tulpn
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ss -tulpn
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/lsof -i

# System monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/top -n 1
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/free -h
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/df -h
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/uptime

# Process monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ps aux
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/pgrep -f {{ validator_service }}

# File monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -lah {{ validator_ledger_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -lah {{ validator_accounts_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/find {{ validator_ledger_dir }} -name "*.log" -type f
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/find {{ validator_accounts_dir }} -name "*.log" -type f

# Snapshot monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/ls -la {{ validator_snapshots_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/du -sh {{ validator_snapshots_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/find {{ validator_snapshots_dir }}

# Performance monitoring (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/vmstat
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/iostat
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/sar

# Log analysis (read-only)
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/grep -r {{ validator_logs_dir }}
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/awk
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/sort
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/uniq
%validator_viewers ALL=(ALL) NOPASSWD: /usr/bin/wc -l
