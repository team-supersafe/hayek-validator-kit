---
# This file displays InfluxDB token summaries for onboarding and additional buckets.

- name: Show InfluxDB token summary
  ansible.builtin.debug:
    msg: |
      InfluxDB onboarding token: {{ influxdb_onboarding_token }}
      {% for bucket in influxdb_additional_buckets %}
      Token for {{ bucket.name }}: {{ influxdb_write_token_result.results[loop.index0].json.token }}
      {% endfor %}

      NOTE: Store these tokens securely as they will not be shown again.
  when: influxdb_onboarding_token is defined and influxdb_write_token_result is defined

- name: Display Deployment Summary
  ansible.builtin.debug:
    msg: |
      ===============================================
      üöÄ MONITORING HUB DEPLOYMENT COMPLETE üöÄ
      ===============================================
      
      The following components have been successfully configured:
      
      ‚úÖ System Updates (apt dist-upgrade)
      ‚úÖ Firewall Rules (UFW configured)
      ‚úÖ InfluxDB (Database & Buckets)
      ‚úÖ Grafana (Visualization Dashboard)
      ‚úÖ Telegraf (Data Collection Agents)
      ‚úÖ Validator Metrics Service
      ‚úÖ Alerting System (Watchtower + Formatters)
      {% if ssl_enabled | bool %}
      ‚úÖ SSL Certificates (Let's Encrypt via Cloudflare){% if ssl_staging | default(false) | bool %} [‚ö†Ô∏è STAGING MODE]{% endif %}
      {% endif %}
      
      -----------------------------------------------
      üîó ACCESS DASHBOARD:
      {% if ssl_enabled | bool %}
      https://{{ ssl_domain }}:{{ grafana_port }}
      {% else %}
      http://{{ ansible_host | default(ansible_host_ip) | default('YOUR_SERVER_IP') }}:{{ grafana_port }}
      {% endif %}
      -----------------------------------------------