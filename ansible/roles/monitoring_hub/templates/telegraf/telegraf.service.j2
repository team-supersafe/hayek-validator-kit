[Unit]
Description=Telegraf {{ item.value.network_name }} Metrics
After=network-online.target
Wants=network-online.target

[Service]
Type=notify
# Load environment variables from centralized file
EnvironmentFile=-/usr/local/etc/validator-metrics.env
NotifyAccess=all
EnvironmentFile=-/etc/default/telegraf
User=telegraf
ExecStart=/usr/bin/telegraf -config /etc/telegraf/telegraf-{{ item.value.network_name }}.conf $TELEGRAF_OPTS
ExecReload=/bin/kill -HUP $MAINPID
Restart=on-failure
RestartForceExitStatus=SIGPIPE
KillMode=mixed
LimitMEMLOCK=8M:8M
PrivateMounts=true

[Install]
WantedBy=multi-user.target