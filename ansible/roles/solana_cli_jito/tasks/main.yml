---
- name: Setup validator directory structure
  ansible.builtin.import_tasks: ../../solana_validator_shared/tasks/setup_validator_directory.yml
  tags: [solana_cli_jito, setup_validator_directory]

# Construct the Jito tag in the format 'v2.2.15-jito' or 'v2.2.15-jito.1'
- name: Set Jito patch suffix
  ansible.builtin.set_fact:
    jito_patch_suffix: "{{ '.' ~ jito_version_patch if (jito_version_patch | default('') | length > 0) else '' }}"

- name: Set Jito tag
  ansible.builtin.set_fact:
    jito_tag: "v{{ jito_version }}-jito{{ jito_patch_suffix }}"

- name: Precheck environment
  import_tasks: precheck.yml
  tags: [solana_cli_jito, precheck]

- name: Install Solana CLI
  import_tasks: install.yml
  when: not jito_cli_already_installed
  tags: [solana_cli_jito, install]

- name: Configure the Solana CLI post installation
  import_tasks: config.yml
  tags: [solana_cli_jito, config]

- name: Verify Solana CLI installation is correct
  import_tasks: verify.yml
  tags: [solana_cli_jito, verify]
