---
- name: cleanup - Remove generated SSH key from destination host authorized_keys
  ansible.posix.authorized_key:
    user: sol
    key: "{{ ssh_key_content_for_cleanup | b64decode }}"
    state: absent
  become: true
  delegate_to: "{{ destination_host }}"
  when:
    - ssh_key_was_generated | default(false) | bool
    - ssh_key_content_for_cleanup is defined
    - ssh_key_content_for_cleanup != ''
    - not ansible_check_mode
